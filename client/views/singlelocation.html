<h1> {{location.name}}</h1>
<h3>Online Users</h3>

<div class="row" id="item-display">
    <div class="container" id="product-list">
        <button style="width: 100%" ng-click="toggle = !toggle">Check In</button>
        <div id="users-search" class="col-sm-4 col-md-5">
            <label id="users-search-label">Search: </label>
            <input id="users-search-field" ng-model="searchText" placeholder="Name, Skills, etc.">
        </div>
        <!-- shows all users that are currently available and unavailable ie. not offline -->
        <div id="product-div">
            <div ng-class="{'location-user-hide' : toggle}" class="col-sm-4 col-md-8" ng-repeat="user in users | filter:{locationname: location.name} | filter: searchText">
                <div>
                    <div class="flex flex-column user-card">
                        <img class="profile-pic" img ng-src="{{ user.imageurl }}" />
                        <h5 class="arvo">{{ user.firstname }} {{ user.lastname }}</h5>
                        <h5 class="arvo">{{ user.displayemail }}</h5>
                        <h5 id="users-skills" class="arvo">{{ user.interests }}</h5>
                        <p><a ng-href="/users/{{ user.userid }}">See Profile</a></p>
                    </div>
                </div>
            <div class="clearfix visible-lg" ng-if="($index + 1) % 6 == 0"></div>
            <div class="clearfix visible-md" ng-if="($index + 1) % 4 == 0"></div>
            <div class="clearfix visible-sm" ng-if="($index + 1) % 3 == 0"></div>
            <div class="clearfix visible-xs" ng-if="($index + 1) % 1 == 0"></div>
        </div>
    </div>
</div>

<div id="single-location-map">

    <div id="map_wrapper">
        <div id="map_canvas" class="mapping"></div>


        <script>
            jQuery(function ($) {
                // Asynchronously Load the map API 
                var script = document.createElement('script');
                script.src = "//maps.googleapis.com/maps/api/js?sensor=false&callback=initialize";
                document.body.appendChild(script);
            });

            function initialize() {
                var map;
                var bounds = new google.maps.LatLngBounds();
                var mapOptions = {
                    mapTypeId: 'roadmap'
                };

                // Display a map on the page
                map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
                map.setTilt(45);

                // Multiple Markers
                var markers = [
                    ['Workaholics, Chattanooga', 35.046151, -85.307571],
                    ['Society of Work, Chattanooga', 35.042901, -85.308673],
                    ['Workhorse, Chattanooga', 35.033978, -85.30242]
                ];

                // Info Window Content
                var infoWindowContent = [
                    ['<div class="info_content">' +
                        '<h3>Workaholics</h3>' +
                        '<p>We are the coworking space for the night owlers. <a href="http://worklatenights.com/"> worklatenights.com/</a>.</p>' + '</div>'],
                    ['<div class="info_content">' +
                        '<h3>Society of Work</h3>' +
                        '<p>Everyone here is into building thingsâ€”startups, communities, freelance networks, individual relationships. Anything with a pulse. Please visit us at: <a href="http://societyofwork.com">societyofwork.com</a> .</p>' +
                        '</div>'],
                    ['<div class="info_content">' +
                        '<h3>Workhorse</h3>' +
                        '<p> All you need to haul your workload and nothing else. More info at: <a href="https://gettowork.horse">gettowork.horse</a> .</p>' +
                        '</div>']
                ];

                // Display multiple markers on a map
                var infoWindow = new google.maps.InfoWindow(), marker, i;

                // Loop through our array of markers & place each one on the map  
                for (i = 0; i < markers.length; i++) {
                    var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
                    bounds.extend(position);
                    marker = new google.maps.Marker({
                        position: position,
                        map: map,
                        title: markers[i][0]
                    });

                    // Allow each marker to have an info window    
                    google.maps.event.addListener(marker, 'click', (function (marker, i) {
                        return function () {
                            infoWindow.setContent(infoWindowContent[i][0]);
                            infoWindow.open(map, marker);
                        }
                    })(marker, i));

                    // Automatically center the map fitting all markers on the screen
                    map.fitBounds(bounds);
                }

                // Override our map zoom level once our fitBounds function runs (Make sure it only runs once)
                var boundsListener = google.maps.event.addListener((map), 'bounds_changed', function (event) {
                    this.setZoom(14);
                    google.maps.event.removeListener(boundsListener);
                });

            }

        </script>
    </div>
</div>